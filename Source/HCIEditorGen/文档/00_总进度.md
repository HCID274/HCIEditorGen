# HCIAbilityKit 总进度（重构 V2）

> 项目根目录：`D:\1_Projects\04_GameDev\UE_Projects\HCIEditorGen`
> 引擎版本：`UE 5.4.4`
> 更新时间：`2026-02-12`
> 当前阶段：`Step1-Slice2（待UE手测）`
> 当前策略：`先文档冻结 -> 再切片开发 -> 每切片停测`

## 1. 范围冻结（唯一主线）

- 仅做 `HCIAbilityKit`，不扩展到无关系统。
- 固定架构：`HCIAbilityKitRuntime + HCIAbilityKitEditor`（插件双模块）。
- 固定目标：建立 `数据 -> AI -> 资产` 管线，解决填表、检索、校验三类痛点。
- 固定流程：`计划 -> 执行 -> 审阅`，敏感操作必须授权门禁。

## 2. 已完成事实（不回滚）

- 环境准备与工程可编译状态已确认通过。
- Import/Reimport 基础闭环已在 UE 中验证通过（含源路径可见）。
- 插件双模块方向已达成决策共识（本次方案进一步升级为 V2）。
- 插件骨架已落地：`HCIAbilityKitRuntime + HCIAbilityKitEditor`，命令行编译通过，等待 UE 手测门禁确认。
- Step1-Slice1 UE 手测已通过（Reimport 正常）。
- Step1-Slice2 代码迁移完成：资产类/Factory/菜单迁移至插件双模块，编译通过，等待 UE 手测。

## 3. Roadmap（四步）

## Step 1 结构迁移（进行中）

- 目标：在不改变现有行为的前提下，迁移到插件双模块骨架。
- 完成标准：
  - Import/Reimport 行为与当前一致；
  - Runtime/Editor 依赖方向正确；
  - UE 手测通过后才进入 Step 2。

## Step 2 服务抽离（待开始）

- 目标：解析/校验从 Factory 抽离到 Runtime 服务层，引入 Python 脚本驱动。
- 完成标准：
  - Factory 仅编排，不包含核心解析逻辑；
  - 解析与校验可独立验证；
  - UE 手测通过。

## Step 3 AI 注入（待开始）

- 目标：接入 LLM，支持 Skill 文档驱动的语义路由。
- 完成标准：
  - 能正确命中 Skill；
  - 敏感操作有授权门禁；
  - 生成结果具备审计记录。

## Step 4 UI 升级（待开始）

- 目标：实现交互式审阅界面（计划清单 + 字段 Diff + 局部采纳）。
- 完成标准：
  - 用户可逐项采纳建议；
  - 可见旧值/新值；
  - 支持回滚与重试。

## 4. 测试门禁（强制）

- 每个切片必须执行：编译 -> UE 手测 -> 记录。
- 用户未明确 `Pass`，不得进入下一切片。
- 记录目录：`Source/HCIEditorGen/文档/测试记录/`
- 测试源数据：`SourceData/AbilityKits/`

## 5. 当前切片（下一步）

- 切片编号：`Step1-Slice2`
- 当前状态：`代码完成，等待UE手测结论`
- 切片目标：将 `UHCIAbilityKitAsset`、`UHCIAbilityKitFactory` 与右键 Reimport 菜单迁移到插件模块，并保持行为不变。
- 验收动作（UE）：
  - 打开工程并编译 Editor；
  - 验证 AbilityKit 资产右键 `Reimport` 菜单仍可见且可点击；
  - 修改样例源文件并执行 Reimport，确认字段更新；
  - 关闭并重开工程后，老资产类型仍可正常识别（验证类重定向）。
- 通过后动作：写测试记录并进入 `Step1-Slice3`（迁移收口与旧模块减负）。

## 6. 文档索引（冻结）

- 技术方案：`Source/HCIEditorGen/文档/01_技术方案_插件双模块.md`
- 测试门禁：`Source/HCIEditorGen/文档/02_测试门禁与节奏.md`
- 契约规范：`Source/HCIEditorGen/文档/03_Schema_v1与错误契约.md`

## 7. 进度日志

- `2026-02-08`：完成环境准备并建立基础文档体系。
- `2026-02-09`：完成 `UHCIAbilityKitAsset` 与 Import/Reimport 闭环验证。
- `2026-02-11`：确认采用插件双模块方向（Runtime + Editor）。
- `2026-02-12`：按新方案重置为 V2 路线，冻结“智能中介者 + 四步演进 + 强制停测”。
- `2026-02-12`：完成 Step1-Slice1 代码侧骨架（新增 `Plugins/HCIAbilityKit` 双模块并启用插件）；`Build.bat HCIEditorGenEditor Win64 Development` 编译通过，待 UE 手测后决定是否进入 `Step1-Slice2`。
- `2026-02-12`：用户确认 Step1-Slice1 UE 手测通过（Reimport 正常）。
- `2026-02-12`：完成 Step1-Slice2 代码迁移：`UHCIAbilityKitAsset` 迁入 `HCIAbilityKitRuntime`，`UHCIAbilityKitFactory` 与 Reimport 菜单迁入 `HCIAbilityKitEditor`，旧模块同名实现已移除，新增 `ActiveClassRedirects`；命令行编译通过，待 UE 手测。
