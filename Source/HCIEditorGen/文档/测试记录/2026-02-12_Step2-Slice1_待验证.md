# 测试记录

- 日期：2026-02-12
- 切片编号：Step2-Slice1
- 测试人：用户

## 1. 测试目标

- 验证解析/校验逻辑已从 `UHCIAbilityKitFactory` 抽离到 Runtime 服务层，Import/Reimport 行为保持一致。

## 2. 影响范围

- `Plugins/HCIAbilityKit/Source/HCIAbilityKitRuntime/Public/Services/HCIAbilityKitParserService.h`
- `Plugins/HCIAbilityKit/Source/HCIAbilityKitRuntime/Private/Services/HCIAbilityKitParserService.cpp`
- `Plugins/HCIAbilityKit/Source/HCIAbilityKitRuntime/HCIAbilityKitRuntime.Build.cs`
- `Plugins/HCIAbilityKit/Source/HCIAbilityKitEditor/Public/Factories/HCIAbilityKitFactory.h`
- `Plugins/HCIAbilityKit/Source/HCIAbilityKitEditor/Private/Factories/HCIAbilityKitFactory.cpp`

## 3. 前置条件

- 插件 `HCIAbilityKit` 已启用。
- 已有 AbilityKit 资产并配置了源路径。
- 测试源文件：`SourceData/AbilityKits/HCI_Fire_01.hciabilitykit`。

## 4. 自动验证（本地）

1. 红灯检查：Runtime 中尚无解析服务，结果 `RED_FAIL_EXPECTED: runtime parser service not found`。
2. 结构检查：Factory 本地 JSON 解析函数已移除，改为调用 `FHCIAbilityKitParserService::TryParseKitFile`。
3. 命令行编译通过：`Build.bat HCIEditorGenEditor Win64 Development`（Exit Code 0）。

## 5. UE 手测步骤

1. 打开 `HCIEditorGen.uproject`。
2. 用合法 `.hciabilitykit` 执行一次 `Reimport`，确认资产字段正常更新。
3. 将 `.hciabilitykit` 改为非法 JSON（例如删逗号），再次 `Reimport`。
4. 确认失败通知仍显示，且包含解析错误原因。
5. 修复 JSON 后再次 `Reimport`，确认恢复成功并且无脏写。

## 6. 预期结果

- Import/Reimport 成功路径与 Slice1 行为一致。
- 失败路径仍有通知与日志，错误原因可定位。
- Factory 仅负责编排与写入，解析规则由 Runtime 服务统一承载。

## 7. 实际结果

- 待填写（用户 UE 手测后回填）。

## 8. 结论

- 待确认（Pass/Fail）。

## 9. 证据

- 编译证据：`Build.bat HCIEditorGenEditor Win64 Development` Exit Code 0。
- UE 日志/截图：待用户补充。
