# HCIEditorGen 项目总进度（开发前计划）

> **项目根目录**：`D:\1_Projects\04_GameDev\UE_Projects\HCIEditorGen`
> **引擎版本**：UE `5.4.4`（固定）
> **更新时间**：`2026-02-08`
> **当前阶段**：M0（计划冻结）进行中
> **范围选择**：A（Editor 工具链优先；`HCIDuel` 在 M1 通过后启动用于验收）
> **当前状态**：环境准备已完成（用户确认）；代码实现由用户手写；本文档可由 AI 协助直接更新

---

## 进度日志（只记事实 + 证据）

> 规则：每次只追加一条；不确定的内容不要写“已完成”，改写“待确认/计划中”。

- `2026-02-08`：确认环境准备完成；仓库/模块骨架已建立；`00_总进度.md` 作为权威进度文件开始维护。
- `2026-02-08`：用户确认尚未开始功能实现；确定下一步为“新增 Editor 模块骨架（HCIEditorGenEditor）”，完成后进入工具链 MVP（M1）编码。
- `2026-02-08`：已落地 Editor 模块骨架（`HCIEditorGenEditor`）并成功编译 Editor；`.uproject` 已添加 Editor 模块描述；Git 忽略规则（根目录 `.gitignore`）已就位。
- `2026-02-09`：已添加 `UHCIAbilityKitAsset`（DataAsset）并在 UE 内验证：可创建/打开/修改/保存字段；已创建 `SourceData/AbilityKits/HCI_Fire_01.hciabilitykit` 样例源文件；处理 UBT + Git 中文路径崩溃：设置 `git config core.quotepath false` 后编译通过。

## 0. 使用规则（这份文档怎么当“权威进度”）

1. **本文档 = 进度权威**：范围/里程碑/目录规范变更，先改本文档，再改代码。
2. **先冻结，再开发**：`M0（计划冻结）`完成前，只允许做“脚手架/目录/文档”工作，不进入功能编码。
3. **每个里程碑都要“可验收”**：必须写清楚验收脚本（怎么操作、看到什么算通过）与证据产物（录屏/日志/报告/截图）。
4. **JSON 永远是唯一权威**：UE 内资产一律视为派生（Derived），允许被 Reimport 覆盖，禁止在 UE 内手改当源头。

---

## 1. 项目一句话（你到底在做什么）

做一条可复现的 UE 编辑器内容管线：  
**SourceData(JSON) → Import/Reimport（右键 Reimport）→ 派生资产（DataAsset/DataTable）→ Runtime 被消费并可验收**。

---

## 2. 目标 / 非目标（从旧文档提炼并锁死）

### 2.1 P0 目标（必须达成）

- **Source-of-Truth**：`SourceData/*.hciabilitykit`（JSON 文本）是唯一权威来源，可在 UE 关闭时编辑。
- **右键 Reimport 必须可用**：内容浏览器选中派生资产 → 右键 `Reimport` → 能从源文件刷新字段并落盘。
- **失败不脏写**：Schema 校验失败/写文件失败/导入失败时，不允许“半成功”污染派生资产。
- **HTTP 可选但必须回退**：在线生成失败/超时/断网/脏数据 → 自动 fallback 到 Mock（编辑器不崩、不阻塞）。
- **闭环证据链可录屏**：改 SourceData → Reimport → 派生资产更新 → PIE/Runtime 读取后“可见变化”（日志/属性/表现任选其一但要稳定）。

### 2.2 P1 目标（加分但不影响 P0 交付）

- **批处理（最小）**：50+ 条批量导入/重导入，输出统计 + 失败清单（可定位到具体文件/条目）。
- **报告留痕**：把成功/失败、耗时、错误聚合输出为可复制文本或落盘报告。
- **差异预览（Dry-run v1，可选）**：导入前列出新增/修改/删除，降低量产风险。

### 2.3 明确不做（防止膨胀）

- 不做平台化（账号/云配置/权限/全局搜索/资产管理后台）。
- 不做复杂 UI（EUW 只需能点、能看日志、能复现）。
- 不做 Runtime 本地推理硬集成（llama.cpp/LibTorch 等放到 P2 以后再说）。
- 不重写 Lyra/Experience/GameFeature 大框架（Runtime 侧只做验收入口）。

---

## 3. 参考文档（Legacy，只用于提炼约束）

> 这些文件来自 `Source/HCIEditorGen/文档/之前的文档/`，后续以“本进度文档 + 新规划文档”为准。

- `Source/HCIEditorGen/文档/之前的文档/00入口.md`：新手启动与最小代码链路示例。
- `Source/HCIEditorGen/文档/之前的文档/01手册_环境准备.md`：UE/MSVC/Rider 环境前置与验证。
- `Source/HCIEditorGen/文档/之前的文档/02手册_编辑器工具链MVP.md`：工具链 MVP 规则（JSON 权威、Reimport、回退、里程碑）。
- `Source/HCIEditorGen/文档/之前的文档/03手册_LyraDogfooding底座.md`：Runtime 验收入口（Exec/Console）与录屏脚本。
- `Source/HCIEditorGen/文档/之前的文档/04手册_打磨与提纯.md`：稳定性/性能/可用性/量产化与投递就绪标准。
- `Source/HCIEditorGen/文档/之前的文档/05手册_投递与面试.md`：包装、素材包、STAR、常见深挖点。

---

## 4. 文档目录规划（开发前先把“该写什么/放哪”写死）

> 本节的“路径”是 repo 相对路径；实际落盘位置以本仓库根目录为准。

### 4.1 开发前必须完成（M0 里程碑前）

- `Source/HCIEditorGen/文档/00_总进度.md`：本文档（总计划 + 里程碑 + 验收口径）。
- `Source/HCIEditorGen/文档/01_范围与术语.md`：范围冻结、术语表、非目标、成功标准。
- `Source/HCIEditorGen/文档/02_Schema与校验.md`：`*.hciabilitykit` Schema v1、校验规则、版本演进策略（v1→v2）。
- `Source/HCIEditorGen/文档/03_Import_Reimport_设计.md`：导入/重导入链路设计（模块边界、关键类、失败策略）。
- `Source/HCIEditorGen/文档/04_验收脚本.md`：成功用例/失败用例/批处理/Runtime 的复现脚本（用于录屏与回归）。
- `Source/HCIEditorGen/文档/99_决策记录.md`：关键决策与取舍（例如“插件 vs 项目模块”）。

### 4.2 开发中同步维护（不阻塞开工，但必须在 M1/M2 前补齐）

- `README.md`：陌生人 10 分钟跑起来（含失败用例与排查）。
- `Source/HCIEditorGen/文档/05_失败用例清单.md`：脏数据/缺字段/断网/超时等失败用例的固定输入与预期输出。
- `Source/HCIEditorGen/文档/06_批处理与报告.md`：批处理策略、报告格式、性能边界与可取消策略（若做）。
- `Source/HCIEditorGen/文档/07_投递素材清单.md`：视频脚本、截图清单、报告样例、面试 STAR 素材索引。

---

## 5. 工程与目录规范（硬约束：先定规范再写功能）

### 5.1 数据目录（Source of Truth）

- `SourceData/AbilityKits/`：权威数据源目录（版本控制）
  - `*.hciabilitykit`：自定义扩展名（内容为 JSON），避免接管全局 `.json` 导入。

### 5.2 UE 内容目录（Derived）

> 目录名可调整，但一旦定下来就写进文档与录屏脚本里，不要来回改。

- `Content/HCI/Tools/`：EUW、图标、调试素材
- `Content/HCI/Data/AbilityKits/`：派生资产（`UHCIAbilityKitAsset` 等）

### 5.3 代码结构（必须 Runtime/Editor 隔离）

两种可行落点（需在 M0 内二选一并写入 `99_决策记录.md`）：

**A. 项目双模块（推荐：落地最快）**
- Runtime：`Source/HCIEditorGen/`（数据模型、Runtime 可用代码）
- Editor：`Source/HCIEditorGenEditor/`（Factory/Reimport/EUW 等 Editor-only 代码）

**B. 插件双模块（推荐：作品集更好，但脚手架略多）**
- `Plugins/HCIAbilityKit/Source/HCIAbilityKitRuntime/`
- `Plugins/HCIAbilityKit/Source/HCIAbilityKitEditor/`

> 当前仓库只有 `Source/HCIEditorGen/` Runtime 模块；如果选择 A，需要新增 Editor 模块；如果选择 B，需要新增插件。

---

## 6. 里程碑与截止日期（用“可验收产物”驱动）

> 日期基于今天 `2026-02-08` 规划；如果节奏变化，**只允许在本文档里改日期**，并记录原因。

### M0：计划冻结（截止 `2026-02-10`，由 `2026-02-07` 顺延：实际开工日晚于原计划）

目标：把“要做什么、放哪、怎么验收”一次性定死，避免边写边摇摆。

- [ ] 冻结目录规范（`SourceData/`、`Content/HCI/...`、模块/插件落点二选一）
- [ ] 冻结 `*.hciabilitykit` Schema v1（字段名、类型、边界、错误输出规则）
- [ ] 写完“必备规划文档”（见 4.1）并互相交叉引用
- [ ] 输出 `M0` 验收脚本（写入 `Source/HCIEditorGen/文档/04_验收脚本.md`）

**验收标准**：
- 任意第三方只看文档就能回答：我们做什么/不做什么/数据从哪来/怎么导入/怎么重导入/失败如何表现/如何录屏验收。

### M1：工具链 MVP 闭环（截止 `2026-02-23`）

目标：用最小功能跑通闭环，必须包含右键 Reimport 的镜头证据。

- [ ] `UHCIAbilityKitAsset`（或等价派生资产）字段对齐 Schema
- [ ] Import：从 `*.hciabilitykit` 生成派生资产（能保存）
- [ ] Reimport：改源文件 → 右键 Reimport → 字段更新并落盘
- [ ] 最小 EUW：能生成/更新 SourceData（可先用 Mock 生成）
- [ ] 输出 30-60 秒录屏脚本（成功路径）

**验收标准（必须可录屏）**：
1) 关闭 UE 改 SourceData  
2) 打开 UE 右键 `Reimport`  
3) 派生资产字段变化可见（并已保存）  

> 说明：Runtime 侧的“消费与生效证明”（dogfooding）放到 `M1.5`（`HCIDuel`）做，不阻塞 `M1`。

### M1.5：`HCIDuel` 最小验收底座（启动点：M1 通过后；截止 `2026-02-27`）

目标：用最小 Runtime 验收入口，证明 `HCIEditorGen` 的工具产物确实能在 PIE/运行时被消费并产生可见变化。

- [ ] 基于 **Lyra Starter Game** 创建/落地 `HCIDuel`（作为独立工程即可，不强制塞回本 repo）
- [ ] 最小验收入口（Exec/Console）：`HCI.ApplyKit <AssetPathOrId>`、`HCI.ActivateTag <GameplayTag>`
- [ ] 验证地图：`HCI_KitValidation`（进入 PIE 后 10 秒内能完成 Apply + Activate + 观测）
- [ ] 输出 Runtime 段落录屏脚本（10-20 秒即可，纳入最终视频）

**验收标准**：
- 使用 M1 的派生资产：在 `HCIDuel` PIE 中执行验收入口后，能稳定观察到变化（日志/属性/表现任选其一），且可复现。

### M2：投递就绪（截止 `2026-03-02`）

目标：从“能跑”升级到“可量产、可定位、可复现、可被信任”。

- [ ] 失败用例 1 个（脏数据/缺字段/断网/超时任选其一）：清晰报错 + fallback（不脏写）
- [ ] 批处理 50+ 条：进度/统计 + 失败清单（可定位）
- [ ] README：陌生人 10 分钟跑起来（含失败用例复现与排查）
- [ ] `HCIDuel` Runtime 验收段落补齐（承接 `M1.5`，形成完整证据链）
- [ ] 90 秒视频脚本与素材包（Reimport 必须出镜；Runtime 为辅）

---

## 7. 工作分解（WBS：按阶段推进，禁止跳阶段）

### Phase 0：规范冻结（对应 M0）

- [ ] 目录规范与命名规范冻结
- [ ] Schema v1 冻结 + 校验策略冻结（缺字段/类型错误/越界/引用非法）
- [ ] 工程结构决策：A 双模块 或 B 双模块插件
- [ ] 验收脚本定稿（成功/失败/批处理/Runtime）

产物：
- 文档：见 4.1
- 目录：`SourceData/AbilityKits/`、`Content/HCI/...`（按需创建）

### Phase 1：数据模型（Runtime）

- [ ] `UHCIAbilityKitAsset` 数据模型（字段与 Schema 对齐）
- [ ] `AssetImportData` 写入与读取（为 Reimport 做准备）
- [ ] （可选）Runtime 读取接口/示例（避免 Gameplay 直接解析 JSON）

验收：
- UE 内能创建/打开该资产，字段可见且类型正确。

### Phase 2：Import / Reimport（Editor-only）

- [ ] Factory：识别 `*.hciabilitykit` 并 Import 生成派生资产
- [ ] Reimport：右键 `Reimport` 能读回源文件并覆盖更新字段
- [ ] 失败策略：校验失败时不修改原资产；错误信息能定位到文件/字段
- [ ] 保存策略：成功才落盘；失败不产生半成品

验收：
- 改源文件后，右键 Reimport 更新字段（录屏必须能看到）

### Phase 3：EUW 入口（生成/更新 SourceData）

- [ ] 最小 UI：当前选择对象/按钮/日志区
- [ ] 生成逻辑 v0：先 Mock（可复现），再替换 HTTP
- [ ] 写文件策略：临时文件写入后 replace（避免损坏）
- [ ] 可选触发：提示或触发 Reimport（至少能指导用户右键 Reimport）

验收：
- 点按钮后，`SourceData/AbilityKits/` 下文件被生成/更新，且格式通过校验。

### Phase 4：稳定性 + 量产化（投递就绪）

- [ ] 批处理：目录扫描 → 逐条导入/重导入 → 统计与失败清单
- [ ] 错误聚合输出：可复制/可落盘
- [ ] 断网/超时/脏数据回退：同一次操作内自动 fallback（编辑器不崩不假写）

验收：
- 50+ 条批处理可复现；失败用例可复现；日志可定位。

### Phase 5：Runtime Dogfooding（`HCIDuel`，在 M1 通过后启动）

> 本总进度范围选择 A（Editor 优先）。`HCIDuel` 不阻塞 `M1`，但会阻塞 `M2`（投递就绪），用于证明工具产物被 Runtime 消费并形成录屏证据链。  
> 若 `HCIDuel` 作为独立工程：本文档只记录“验收口径 + 入口需求 + 素材脚本”，工程细节放到 `HCIDuel` 自己的文档里。

- [ ] `HCI.ApplyKit <AssetPathOrId>`（Exec/Console）
- [ ] `HCI.ActivateTag <GameplayTag>`（Exec/Console）
- [ ] `Apply/Clear` 幂等与可回滚（避免越用越脏）
- [ ] 专用验证地图与录屏脚本

验收：
- 改 SourceData → Reimport → PIE 执行命令 → 日志/表现稳定证明“Kit 生效”。

---

## 8. 统一验收脚本（用于录屏 + 回归）

> 这里先给出“脚本骨架”，最终版写进 `Source/HCIEditorGen/文档/04_验收脚本.md` 并保持与代码同步。

### 8.1 成功用例（闭环）

1. 关闭 UE  
2. 修改 `SourceData/AbilityKits/HCI_Fire_01.hciabilitykit`：把 `params.damage` 改大  
3. 打开 UE → 找到派生资产 → 右键 `Reimport`  
4. 打开派生资产：确认字段已更新  
5. PIE：通过日志/命令/验收入口确认效果变化

### 8.2 失败用例（任选其一固定下来）

- 缺字段/类型错误/越界/断网/超时 → 预期：明确报错 + fallback；派生资产不被污染

### 8.3 批处理用例（50+）

- 扫描目录 → 执行批导入/重导入 → 输出统计（成功/失败/耗时）+ 失败清单（可定位）

---

## 9. 风险与决策点（提前写清，避免开发中翻车）

### 9.1 决策点（M0 内必须落地）

- **工程形态**：项目双模块（A） vs 插件双模块（B）
- **Derived 形态**：DataAsset（优先） vs DataTable（兜底）
- **失败用例选择**：优先选“最容易复现且面试价值高”的一个（例如 Schema 校验失败）

### 9.2 主要风险（及对策）

- Reimport 链路不稳定/接口变动：先以“能右键 Reimport 成功”为第一优先级；必要时先用 DataTable 兜底再回到自定义资产。
- 编辑器卡死：所有网络/耗时操作必须超时与回退；批处理提供进度与错误聚合。
- 数据演进：Schema v1 固定后，新增字段通过版本号/默认值策略演进，避免破坏旧数据。

---

## 10. 下一步（建议今天就做）

- [ ] 在 `99_决策记录.md` 里确定“模块 vs 插件”（写下理由与取舍）
- [ ] 在 `02_Schema与校验.md` 里冻结 Schema v1（把字段范围与边界写死）
- [ ] 把 `04_验收脚本.md` 写出可执行的“成功/失败/批处理/Runtime”脚本（不用等代码写完）

---

## 范围确认（已选）

- 范围：**A**（仅 `HCIEditorGen` 的 Editor 工具链/管线）
- `HCIDuel` 介入点：**M1 通过后启动（M1.5）**，用于 `M2` 的 Runtime 验收与视频素材
