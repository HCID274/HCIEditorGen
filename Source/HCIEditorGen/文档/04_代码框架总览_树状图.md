# HCIAbilityKit 代码框架总览（树内中文注释版）

> 只保留手写源码与配置目录；`Binaries/`、`Intermediate/`、`Saved/`、`DerivedDataCache/` 为生成目录，故省略。

```text
HCIEditorGen/                                                # 项目根目录
|-- HCIEditorGen.uproject                                    # UE 项目描述，模块与插件装配入口
|-- AGENTS.md                                                # 协作规则与开发约定
|-- Config/                                                  # 项目配置
|   |-- DefaultEngine.ini                                    # 引擎级配置
|   |-- DefaultEditor.ini                                    # 编辑器行为配置
|   |-- DefaultGame.ini                                      # 游戏逻辑配置
|   `-- DefaultInput.ini                                     # 输入映射配置
|-- Plugins/                                                 # 可复用功能插件目录
|   `-- HCIAbilityKit/                                       # AbilityKit 主插件
|       |-- HCIAbilityKit.uplugin                            # 插件入口；声明 Runtime/Editor 模块 + PythonScriptPlugin
|       `-- Source/                                          # 插件源码
|           |-- HCIAbilityKitRuntime/                        # 运行时模块（只放可运行时代码）
|           |   |-- HCIAbilityKitRuntime.Build.cs            # Runtime 依赖声明（Core/Engine/Json）
|           |   |-- Public/
|           |   |   |-- HCIAbilityKitRuntimeModule.h         # Runtime 模块类声明
|           |   |   |-- HCIAbilityKitAsset.h                 # 资产数据结构（SchemaVersion/Id/DisplayName/Damage）
|           |   |   `-- Services/
|           |   |       `-- HCIAbilityKitParserService.h     # 解析服务接口 + Python Hook 抽象
|           |   |   `-- Search/
|           |   |       `-- HCIAbilityKitSearchSchema.h      # 检索语义文档与索引结构定义（Slice1）
|           |   |       `-- HCIAbilityKitSearchIndexService.h # 索引服务接口（全量构建/增量刷新/统计）
|           |   `-- Private/
|           |       |-- HCIAbilityKitRuntimeModule.cpp       # Runtime 模块启动/关闭实现
|           |       |-- HCIAbilityKitAsset.cpp               # AssetImportData 初始化与资产注册标签写入
|           |       `-- Services/
|           |           `-- HCIAbilityKitParserService.cpp   # JSON 解析校验 + 调用 Python Hook
|           |       `-- Search/
|           |           `-- HCIAbilityKitSearchSchema.cpp    # 语义映射规则（元素/伤害档位/控制/场景/Tokens）
|           |           `-- HCIAbilityKitSearchIndexService.cpp # 资产索引构建与统计日志输出
|           `-- HCIAbilityKitEditor/                         # 编辑器模块（导入、重导入、菜单、通知）
|               |-- HCIAbilityKitEditor.Build.cs             # Editor 依赖（UnrealEd/ToolMenus/ContentBrowser/PythonScriptPlugin）
|               |-- Public/
|               |   |-- HCIAbilityKitEditorModule.h          # Editor 模块类声明
|               |   `-- Factories/
|               |       `-- HCIAbilityKitFactory.h           # UFactory + FReimportHandler 接口声明
|               `-- Private/
|                   |-- HCIAbilityKitEditorModule.cpp        # 启动注册 Python Hook + 内容浏览器 Reimport 菜单
|                   `-- Factories/
|                       `-- HCIAbilityKitFactory.cpp         # Import/Reimport 主流程 + 失败通知弹窗
|-- Source/                                                  # 项目本体源码（目前主要保留目标与文档）
|   |-- HCIEditorGen.Target.cs                               # Game Target
|   |-- HCIEditorGenEditor.Target.cs                         # Editor Target
|   `-- HCIEditorGen/
|       |-- HCIEditorGen.Build.cs                            # 本体模块构建规则
|       |-- HCIEditorGen.cpp                                 # 本体模块实现（轻量壳）
|       |-- HCIEditorGen.h                                   # 本体模块声明
|       `-- 文档/                                             # 开发/测试/进度文档目录
|           |-- 00_总进度.md                                  # 总进度主索引
|           |-- 01_技术方案_插件双模块.md                      # 架构方案文档
|           |-- 02_测试门禁与节奏.md                           # 测试节奏与门禁规则
|           |-- 03_Schema_v1与错误契约.md                      # Schema 与错误契约
|           |-- 04_代码框架总览_树状图.md                      # 当前这份结构总览文档
|           `-- 测试记录/                                      # 每个 Slice 的手测记录
`-- SourceData/                                              # 外部源数据与工具脚本（非 UE 资产目录）
    `-- AbilityKits/
        |-- HCI_Fire_01.hciabilitykit                        # 样例源文件（导入/重导入输入）
        `-- Python/
            `-- hci_abilitykit_hook.py                       # UE 内置 Python 钩子脚本（可触发受控失败）
```

```text
Import/Reimport 执行链路（当前）
.hciabilitykit -> UHCIAbilityKitFactory(Editor) -> FHCIAbilityKitParserService(Runtime)
-> hci_abilitykit_hook.py(可选) -> ApplyParsedToAsset(UHCIAbilityKitAsset)
-> AssetImportData.Update + MarkPackageDirty
```
